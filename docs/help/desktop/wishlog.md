# 祈愿记录

::: tip 提示
此功能在现阶段有很严重的性能问题
:::

## 云备份

寻空提供祈愿记录的云备份功能，**但是不能保证服务的可靠性**。

云备份功能使用 **从您本地原神日志中找到的祈愿记录网址** 验证账号所有权，验证通过即视为您本人操作，可从服务器中 `下载`、`上传`、`删除` 相关 Uid 的祈愿记录。

服务器没有冗余备份，定期备份由阿里云提供。

## 导入

支持从 Excel 文件或 Json 文件导入祈愿记录，每次只能导入一个账号的数据，导入文件的格式要求如下：

### Excel 文件

导入的 Excel 文件需要包含名为`原始数据`的工作表，该表的内容符合以下格式（列顺序不做要求）：

| uid       | gacha_type | id                  | item_type | lang  | name       | rank_type | time                 |
| --------- | ---------- | ------------------- | --------- | ----- | ---------- | --------- | -------------------- |
| 123456789 | 100        | 1613307960000763747 | 武器      | zh-cn | 神射手之誓 | 3         | 2021-02-14  21:50:21 |

::: warning 警告
以上格式中的每一列**必须**存在，每一列**必须**要有值。
:::

### Json 文件

寻空会遍历 Json 文件的每个元素，但只有以下格式的对象才会被解析：

``` json
{
    "uid": "123456789",
    "gacha_type": "100",
    "time": "2021-02-14 21:50:21",
    "name": "神射手之誓",
    "lang": "zh-cn",
    "item_type": "武器",
    "rank_type": "3",
    "id": "1613307960000763747"
}
```

::: warning 警告
同样地，上述对象的每个字段**必须**存在，每个字段**必须**要有值，不得为`null`或`""`。
:::

### 导入过程中的常见错误

#### Imported wishlogs have items without uid

Json 文件中没有 `uid` 字段或 `uid` 字段为 `"0"`。

#### Please check sheetName/Index is correct

Excel 文件的工作表格式与上述要求不相符，请仔细检查每一列。

#### DbUpdateException

一般情况下是因为 Json 文件中的某些字段的值为 `null`，需修改为相应的正确值。

若仍出现此问题，请去 [提 Issue](https://github.com/Scighost/Xunkong/issues) 并附上相关日志。

## 导出

正在准备中
